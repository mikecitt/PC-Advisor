package rules1;

import com.pcadvisor.pcadvisorapi.model.ComputerProgram;
import com.pcadvisor.pcadvisorapi.drools.model.BestUsageArea;
import com.pcadvisor.pcadvisorapi.drools.model.QuestionScores;
import com.pcadvisor.pcadvisorapi.model.UsageArea;
import com.pcadvisor.pcadvisorapi.model.SurveyQuestion;
import com.pcadvisor.pcadvisorapi.dto.PriorityDTO;
import com.pcadvisor.pcadvisorapi.dto.ComputerProgramsResponseDTO;
import com.pcadvisor.pcadvisorapi.dto.SurveyQuestionRequestDTO;

global QuestionScores questionScores;
global ComputerProgramsResponseDTO computerProgramsResponse;

rule "Questions"
    when
        questionRequestDTO: SurveyQuestionRequestDTO($id: id, $score: score)
        $surveyQuestion: SurveyQuestion(id == $id, $usageArea: usageArea)
    then
        modify(questionScores) { getScores().put($usageArea, questionScores.getScores().get($usageArea) + $score) }
    end

rule "Computer Programs"
    when
        $computerProgram: ComputerProgram($usageArea: usageArea)
        usageArea: BestUsageArea(usageArea contains $usageArea)
    then
        computerProgramsResponse.getComputerPrograms().add($computerProgram);
    end

rule "Gaming"
no-loop true
    when
        $computerProgram: ComputerProgram(usageArea == UsageArea.GAMING)
        $priorityDTO: PriorityDTO(gpuPriority < 5)
    then
        modify($priorityDTO) { setGpuPriority(5) };
        modify($priorityDTO) { setRamPriority(4) };
        modify($priorityDTO) { setCpuPriority(3) };
    end

rule "Programming"
no-loop true
    when
        $computerProgram: ComputerProgram(usageArea == UsageArea.PROGRAMMING)
        $priorityDTO: PriorityDTO(cpuPriority < 5)
    then
        modify($priorityDTO) { setGpuPriority(1) };
        modify($priorityDTO) { setRamPriority(4) };
        modify($priorityDTO) { setCpuPriority(5) };
    end

rule "Modeling 3d"
no-loop true
    when
        $computerProgram: ComputerProgram(usageArea == UsageArea.MODELING_3D)
        $priorityDTO: PriorityDTO(gpuPriority < 6)
    then
        modify($priorityDTO) { setGpuPriority(4) };
        modify($priorityDTO) { setRamPriority(5) };
        modify($priorityDTO) { setCpuPriority(6) };
    end

rule "Graphic design"
no-loop true
    when
        $computerProgram: ComputerProgram(usageArea == UsageArea.GRAPHIC_DESIGN)
        $priorityDTO: PriorityDTO(gpuPriority < 6)
    then
        modify($priorityDTO) { setGpuPriority(6) };
        modify($priorityDTO) { setRamPriority(5) };
        modify($priorityDTO) { setCpuPriority(4) };
    end

rule "Office"
no-loop true
    when
        $computerProgram: ComputerProgram(usageArea == UsageArea.OFFICE)
        $priorityDTO: PriorityDTO(ramPriority < 3)
    then
        modify($priorityDTO) { setRamPriority(3) };
    end